<div align="center">
  <img src="https://github.com/ericmaddox/crime-analyst-ai/raw/main/media/crime_analyst_ai.JPEG" alt="Crime Analyst AI" width="200" />
</div>

# Crime Analyst AI
[![Powered by Ollama](https://img.shields.io/badge/Powered%20by-Ollama-blue)](https://ollama.com)


This project leverages Python, Folium and the Llama AI model to analyze crime data and predict future crime trends. It visualizes actual crime data on a map and provides narrative insights from the AI model. Additionally, the script validates predictions using both the Llama model and historical crime data to ensure predictions are realistic and geographically plausible.

![Crime Analyst AI Map](https://github.com/ericmaddox/crime-analyst-ai/blob/main/media/crime_analyst_ai_map.JPG)


## Table of Contents

- [Installation](#installation)
- [Usage](#usage)
- [Outputs](#outputs)
- [Customization](#customization)
- [Contributing](#contributing)
- [License](#license)
- [Acknowledgments](#acknowledgments)

## Installation

### Prerequisites

Ensure you have Python 3.8 or higher installed on your system. Install the necessary libraries using pip:

```bash
pip install -r requirements.txt
```

### Setting Up Ollama

1. **Download and Install Ollama**:
   Follow the instructions provided on the [Ollama website](https://ollama.ai) to download and set up Ollama on your local machine.

2. **Pull the Ollama Model**:
   ```bash
   ollama pull llama3.2
   ```

3. **Verify Model Availability**:
   ```bash
   ollama list
   ```

## Usage

1. **Prepare the CSV or XLSX File**:
   - Ensure your crime data file is named `sample_crime_data.csv` or `sample_crime_data.xlsx` and placed in the same directory as your script.
   - If your file has a different name, update the `file_path` variable in the script to match your file name.

   ```python
   file_path = 'your_crime_data_file.csv'  # Replace with your actual file name
   ```

2. **Modify the Script (if necessary)**:
   - Open the script file `crime_analyst_ai.py`.
   - Locate the function `run_ollama_predictive_model`.
   - Modify the model name within the script to match the Ollama model you are using. For example, if you are using a different model, replace `llama3.2` with your model name.

   **Example Modification**:
   ```python
   def run_ollama_predictive_model(prompt):
       """Run Ollama AI model to generate or process crime data."""
       try:
           process = subprocess.run(['ollama', 'run', 'YOUR_MODEL_NAME_HERE', prompt], capture_output=True, text=True, check=True)
   ```

3. **Run the Script**:
   - Execute the script:
     ```bash
     python3 crime_analyst_ai.py
     ```

## Outputs

- **Map File**: `crime_analyst_ai_map.html` visualizes both actual crime data and predictive insights.
- **Narrative Analysis File**: `predicted_crime_analysis.txt` contains the narrative output from the Ollama model.

## Customization

You can customize the script to include additional machine learning models for further predictive analysis. The script includes additional validation features:

- **Prediction Validation**: Predictions made by the Llama model are validated against historical crime data to ensure they make sense geographically and temporally.
  
- **Likelihood Validation**: A validation step ensures the likelihood values generated by Llama are within a valid range (0-100%).

### Performance Optimization

The script processes large CSV files in chunks to handle large data efficiently.

### Enhanced Visualization

The map visualization includes interactive features, such as tooltips and different marker colors for various crime types.

## Contributing

Contributions are welcome! Feel free to submit a pull request or open an issue to discuss improvements, bug fixes, or new features.

## License

This project is licensed under the MIT License.

## Acknowledgments

I would like to extend my thanks to the following resources and individuals:

- **Folium**: For providing an excellent library to visualize geospatial data on interactive maps. [Folium GitHub](https://github.com/python-visualization/folium)
- **Pandas**: For the powerful data analysis and manipulation capabilities. [Pandas Documentation](https://pandas.pydata.org/pandas-docs/stable/)
- **Openpyxl**: For reading and writing Excel files. [Openpyxl GitHub](https://github.com/jmcnamara/openpyxl)
- **Llama**: For the AI model used for crime data analysis and prediction. [Ollama AI](https://ollama.ai)
